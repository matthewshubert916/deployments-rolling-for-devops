---
services: docker

branches:
  only:
    - master

env:
  - playbook: ''
    shell_script: molecule.sh

script:
  # Use test shim and run playbook if playbook is provided.
  - |
      if [ ! -z "$playbook" ]; then
        # Download test shim.
        wget -O ${PWD}/tests/test.sh https://gist.githubusercontent.com/geerlingguy/73ef1e5ee45d8694570f334be385e181/raw/
        chmod +x ${PWD}/tests/test.sh
        # Run tests.
        ${PWD}/tests/test.sh
      fi

  # Run script directly if script is provided.
  - |
      if [ ! -z "$shell_script" ]; then
        ${PWD}/tests/${shell_script}
      fi
